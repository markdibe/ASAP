{"version":3,"file":"angular-date-value-accessor.js","sources":["../../../projects/date-value-accessor/src/lib/date-value-accessor.ts","../../../projects/date-value-accessor/src/lib/date-value-accessor.module.ts","../../../projects/date-value-accessor/src/lib/local-date-value-accessor.ts","../../../projects/date-value-accessor/src/lib/local-date-value-accessor.module.ts","../../../projects/date-value-accessor/src/public-api.ts","../../../projects/date-value-accessor/src/angular-date-value-accessor.ts"],"sourcesContent":["import { Directive, ElementRef, HostListener, Renderer2, forwardRef } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\n\nexport const DATE_VALUE_ACCESSOR: any = {\n  provide: NG_VALUE_ACCESSOR,\n  useExisting: forwardRef(() => DateValueAccessor),\n  multi: true\n};\n\n/**\n * The accessor for writing a value and listening to changes on a date input element\n *\n *  ### Example\n *  `<input type=\"date\" name=\"myBirthday\" ngModel useValueAsDate>`\n */\n@Directive({\n  // this selector changes the previous behavior silently and might break existing code\n  // selector: 'input[type=date][formControlName],input[type=date][formControl],input[type=date][ngModel]',\n\n  // this selector is an opt-in version\n  // tslint:disable-next-line: directive-selector\n  selector: '[useValueAsDate]',\n  providers: [DATE_VALUE_ACCESSOR]\n})\n// tslint:disable-next-line: directive-class-suffix\nexport class DateValueAccessor implements ControlValueAccessor {\n\n  @HostListener('input', ['$event.target.valueAsDate']) onChange = (_: any) => { };\n  @HostListener('blur', []) onTouched = () => { };\n\n  constructor(private renderer: Renderer2, private elementRef: ElementRef) { }\n\n  writeValue(value: Date): void {\n    if (!value) {\n      this.renderer.setProperty(this.elementRef.nativeElement, 'value', null);\n      return;\n    }\n    this.renderer.setProperty(this.elementRef.nativeElement, 'valueAsDate', value);\n  }\n\n  registerOnChange(fn: (_: any) => void): void { this.onChange = fn; }\n  registerOnTouched(fn: () => void): void { this.onTouched = fn; }\n\n  setDisabledState(isDisabled: boolean): void {\n    this.renderer.setProperty(this.elementRef.nativeElement, 'disabled', isDisabled);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { DateValueAccessor } from './date-value-accessor';\n\n@NgModule({\n  declarations: [DateValueAccessor],\n  exports: [DateValueAccessor]\n})\nexport class DateValueAccessorModule { }\n","import { Directive, ElementRef, HostListener, Renderer2, forwardRef } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\n\nexport const LOCAL_DATE_VALUE_ACCESSOR: any = {\n  provide: NG_VALUE_ACCESSOR,\n  useExisting: forwardRef(() => LocalDateValueAccessor),\n  multi: true\n};\n\n/**\n * The accessor for writing a value and listening to changes on a date input element\n *\n *  ### Example\n *  `<input type=\"date\" name=\"myBirthday\" ngModel useValueAsLocalDate>`\n */\n@Directive({\n  selector: '[useValueAsLocalDate]',\n  providers: [LOCAL_DATE_VALUE_ACCESSOR]\n})\n// tslint:disable-next-line: directive-class-suffix\nexport class LocalDateValueAccessor implements ControlValueAccessor {\n\n  onChange: any = () => {};\n\n  @HostListener('input', ['$event.target.valueAsDate']) onInput = (date: Date) => {\n    let selectedDate: Date | null = null;\n    if (date) {\n      // Create LOCAL Date, time is set to 00:00 in LOCAL time\n      selectedDate = new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());;\n    }\n    this.onChange(selectedDate);\n  }\n  @HostListener('blur', []) onTouched = () => { };\n\n  constructor(private renderer: Renderer2, private elementRef: ElementRef) { }\n\n  writeValue(date: Date): void {\n    // Create UTC Date, time is set to 00:00 in UTC time\n    const utcDate: Date = date ?\n      new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate())) :\n      null;\n    this.renderer.setProperty(this.elementRef.nativeElement, 'valueAsDate', utcDate);\n  }\n\n  registerOnChange(fn: (_: any) => void): void { this.onChange = fn; }\n  registerOnTouched(fn: () => void): void { this.onTouched = fn; }\n\n  setDisabledState(isDisabled: boolean): void {\n    this.renderer.setProperty(this.elementRef.nativeElement, 'disabled', isDisabled);\n  }\n}\n\n// Use Local Dates with html input type date\n// https://stackoverflow.com/questions/53032953/what-is-the-correct-way-to-set-and-get-htmlinputelement-valueasdate-using-local\n","import { NgModule } from '@angular/core';\nimport { LocalDateValueAccessor } from './local-date-value-accessor';\n@NgModule({\n  declarations: [LocalDateValueAccessor],\n  exports: [LocalDateValueAccessor]\n})\nexport class LocalDateValueAccessorModule { }\n","/*\n * Public API Surface of date-value-accessor\n */\n\nexport * from './lib/date-value-accessor';\nexport * from './lib/date-value-accessor.module';\nexport * from './lib/local-date-value-accessor';\nexport * from './lib/local-date-value-accessor.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}